use dump1090;

-- Load the FAA registry CSV files
LOAD DATA LOCAL INFILE 'ACFTREF.csv'
	IGNORE
	INTO TABLE FAA_to_ICAO_Type_Mapping
	FIELDS TERMINATED BY ','
	LINES TERMINATED BY '\r\n'
	IGNORE 1 LINES;
LOAD DATA LOCAL INFILE 'MASTER.csv'
	REPLACE
	INTO TABLE FAA_Registry
	FIELDS TERMINATED BY ','
	LINES TERMINATED BY '\r\n'
	IGNORE 1 LINES;

-- Post import cleanup

--DELETE FROM FAA_to_ICAO_Type_Mapping WHERE MFR NOT REGEXP '^AEROSPATIALE|^AIRBUS|^BOEING|^BOMBARDIER|^CANADAIR|^DOUGLAS|^EMBRAER|^MCDONNELL';

--DELETE FROM FAA_Registry WHERE STATUS_CODE NOT LIKE 'V';

--UPDATE FAA_Registry SET N_NUMBER = Concat('N', N_NUMBER);
